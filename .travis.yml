sudo: required
language: node_js
services:
- docker
install:
- echo "install nothing!"
script:
- echo "no tests!"
after_success:
- docker --version
- pip install --user awscli
- export PATH=$PATH:$HOME/.local/bin
- eval $(aws ecr get-login --region eu-west-2 --no-include-email)
- docker build -t unininja-api --build-arg MONGODB_URI=$MONGODB_URI --build-arg MONGODB_DATABASE=$MONGODB_DATABASE
  .
- echo $MONGODB_DATABASE && echo $MONGODB_URI
- docker tag unininja-api:latest 581440852996.dkr.ecr.eu-west-2.amazonaws.com/unininja-api:latest
- docker push 581440852996.dkr.ecr.eu-west-2.amazonaws.com/unininja-api:latest
- aws ecs update-service --cluster unininja-cluster --service unininja-service --force-new-deployment
env:
  global:
  - secure: kuF0NzU+GnciCvZvCiucWoeRF+/4az/Hd7UrngUZr7Ei9mfHslsJzgYWhBUPGC4lqeESghoUEy+94hUAP+iGt7YeKTqcHGqNEsXaAGGI3EegX+x1Z17CVpEV3Li5gxVpyG5FkPuvHr+BFVH8HSmCtj9Fd+n0yEaL2EMBp2gekClTR7lmcvl0snbb4oqhyQ6k7+kL9udQwy1LmW/dj+1jvhOhwU1zoR7j1o9GsvXRJp+Q5P4301+o2XiEBVkYce1x6zelStJjqkoUB1J6/l/Hurmm58ZfY4rKn9DNL5aheCtzXzKJHrvITqktLVzPR5Y/BlwpPeul9k0OsElYuv0w/wQxn93Vht+0FQJbbYPZs8nS7LagiYH1/QCrlWneySH0wjwssbaw6lRqi9VFSZ8bcZq0taA1Y/OFFTS0avkcTjGbIUwj9SN/Duf3bx0lhNALSiKMp08ECHxn4l5LXWFUESlsJb0HXw5El8Hn4eu2ShmlhVSGH/22lrjlOJwwd+BLOeK72tNr+KbNmBbSFNvAPYiaLXLa/PA8Bs9GfMJ5pGh7+5LltrBxrylcQj33mVpDMkfr1/yPT/E1dUdHt41wWEJW68jinuSwbcFU6yem+ktL52b6ZSiLskCILy98hRmNWHZN0NHeqheOcE1fhZt2Sv9zSXXHUqVKJ93xvESBmpY=
  - secure: dej2mbRxZM12kqAgxDOxnK0Z+gWPRr2Ukv6XDlp40tCUUh7O2dYyQPJt5gED24u2+CzvQ7sdAStULUj+S0g5LL1lLtAZV4+kxDcm22xLauIWhN89I7dl7npchksQZiEKSqkvtgnnQktTnztK3+GEcL1+2o2uV3cOeJ8wnRu32Vx0b9B2YgvsAXMI+d39ODLx/jagJaSmeZshE54s50LTtqkFvbtFDAvM6YiuE8ue2ILLi2Y94RpsVhJIqTmfmpdZHGJzBEYoj76+B1q0ajGPGftdgXalEmDqUhvGoHXKU6AjELz4AJqMgb1Wxi9A7RQMmot+YkC0LavVutS1dhCqEfmNAPwU8ePg7KCjWU0C9lb7bS/06p3E1fxPdxvYofFZ86E8eBKffZ4KrX2ukoNfwVxTy8DZlUg2sd9SO0oJZ0LVcfSNy65KXvOwp3FKa4E1cG9B9UQ/YLkj05qaJhdTfwQ6MkPxveMJjNMSzkTc7M+Y6TbXnHxcppuU8TNMz5YBb+Mjin4vlwZIgsNqUs4Hl11mQzx56eQW+V2h2JQH48T9BoBcfVwUH/sQTwQTaA5xlNyjmKQ8O5BgBGSOaWmvVFvkVjyVdBspRFFiicniaL0vACfDZFu/rDdRqjTaXoKABDwJZRWHLSQEBIK7yHOpToX2s9MWb/p7e5jU+b7Oszw=
  - secure: vp8gJWpReO23IizrbnXwkEQDU8LVipt2rWZI2/nnCL2SXOk5g4D9JfnNTgVtl13M/EAeNeZm0OIY5J1FXCofb0F+Ie+XgYi13Lzv+y1qBTa+hA29mP+BVxu6C+ogWnG9B1SXOrqF7AaapDlDE9yjLysYhxBSCf/7xEXASQ6qunk/PCm8t+7Jk3WAHHDwgoytp/e3DBz9/8W6hkPNQkv6hblRKFGZUBHQ9n3pf9ZCckmdj2NUZa0zCpwVTA/UKgm/k1cL3yhEuRXH1J0m/xqMgzXSS16vY+26r+2cbZ5sWycS+Xs7FaiPZz0EMiT9DMKcuq42i/IhKR/HUugQ7a8UobXBRMYXBCCCn6L2K5YDQeK3uin9o1jI9aeHwQvu0D9EVVIk5drUAS/OlH7j5rO1WwGTbqYGqzPTHRVk8+vUcpAClDh1kw5tJerNoylncgK8ZXKDTyuy6MjnIsqkTmnSAtleA+ToBnFEW4PM6kC8UcSp/wQhPLvlZm3XZcMFS+n2ly2lGb7wNroWOshLRhe3eZizLIwiC49WVJeDkKBF9twq8+fz3hh5Vt1W3ZFM5B1d9pV0fowrJIzzfj/Pz1UW113LGBzJ63GVsJaoQc5G5uD3L4BpYYBeYFRezpqju7SuF9b248v5TIxPp317QceWzXFls3FVBmz5KGCI3eVD7Yo=
  - secure: eIe78ozufLdZA8sXeqoAsRBdJcCj+M/ZkGadXAemIlNIhZickUQyYZMl9JJjMaqmPw8JsGbQvLF8TqE52WK+nPtESdsnF9hi4uiKLSmHIt8HjUQv6u7T9Aajlo1JyqjQ6aRLKwciUj656Jhz02XWiYjp94AlCoBEgiBBRK/jub/MdQcxCsAzb2YeQ87nU+SxoJOmS+13eixAoqLr7aPSSMOuWd65B/uGL4JXbY+7MNCZCQOWfve+PL5N54b/zhlZGS2FJrHatk+chMW+eATgh56xBrwNpjkC9BXQaFQpXRNm0Vp0pi+jB1ubwnJRIw+aGO83UkdlB3Bs6vrxY5XCmrIDtAFn1Ul1ri8hixCjFavBYRgDCqyJWvTuXRVwygmaMxbA3E42LxZzEglwfkTsut3zFFTkZJBjSeDQgFkyVcyKeEZWeqJL+QwQfDGplR1rwZwk7aNWAVG6xr5QT4nDuyDJ5/E+ldULzLmC45HplimGcLWP1FsmNhZM3URorRXFNdzPbhHAheuUdbCu10TM0FnIpW+/gK/2lDjOONrx5vfzW/0vOAoCNi984tdYcs1jXEn5j/vzWCQ1QxGVb5jppOFltj+OXBfTo5TTR6M50Lz5PQZiw0AOnM/ujFAY/rcIZ3SyUWP9oJf5UoT8gaHcrQtAhGKSBxcDkOceU0XAjdg=
  - secure: OR4aabirWEs8E+CC4+ZNQBGZid+mwh8HEnuBe6kZpZBYiQa7BB0g76aeaX1tJopkr30h/mkChqus+/q1JS2Yo3xZ4wmBhQ0vKCnHNkJSiaCmCcd0OyaC0XD6iSOsVkOtodK37eQRCdIhYgeBDjOckBFf881oCFkR96dJRshY2L0+1fYM7rnApYyj1Ih6SUIcTVxsIh8kaYl4ue9QX4la/GLsnLXBYegxR263gLodwVwzcol8Zt+30ftL7Zvov+yXwGpAkgeSqOOuU0b6L8mI7pCcfN+MJ5dC5xlN0zY6/TtmGQCHq9fMfr/phN171CGJI+dIv50+fCTAFP4Qx/Dr4sFkr+ipubeyVtnKksMn/EXFQ9zoEckQZqLp+m5tRyOtZd0hQ0skKb+hSOjA5WYfA24wxYz+T/jQyjtfM8TVR+lHu16FR8/To8qhj9gUt3ib21sNlonB+xuaBfm4iuRH6CZb0Ih48v9mrSCtrTu4mb3OHiLX4OJCx86HAxeQXSNtnhY/Kk4m1YXwvLzUya3om/WQXRTfb9TDIpd8YFz5fENAcnYGlNfEGBfLSDY4BCBliJpv/f5UQBvyMVu70sMiACReMWXCTz2kCcN2hftsHuItTmnuK046563YPTH2hVEyDQl2TK4lUt9TJ0qreE5I1WStgciZaTe/Tf9pdCeIdTQ=
  - secure: rY1rnNuJlN1AN01LFiniEx9ZkK10YhcnAE0HBrNRybR/RJsqOj5/kIXBzshptbnrsUouAHjLu5vXQG0oAXxcVwYBM3KziaJVVQ/vKqZZySF41Hb3GzS5oobaKO7X1oKwday/I2mcXa3PR+E54z3bpQZleRolVR+kcB1xNV+k7ETrfRcSI48uTpxkkW7rLsvXhZEcnuzJiYdf6+kp/47BsYVa5MRz29iPo2JcKGXHlKwTAxa4IhGFCDpmVV+zpwL46ELwIFfPqvZydwqiPyECGuseFFQr9kYHYY8GaBjC6iOiO06Jgk6x6lF5hylSRrseHlJZI7HhRZk0b4VXLaYxp5qtj25dvoYP4z07bugChKJ0+eSFvXyCDWLub7TCZROzskkXU0q3tl8b1taQWZvab5/2drTZVEe2laW/egytOiW0fXKuUn+syApmn8WXO82rzsC1PWP4MQGA0q0z0VA4E53KdmsT8ALLSxA7sv6/myqvE8uK5Icr5b2YJRW8M6F0lOjQgi0zMaX2fB4ScONGJCoyq8n3a0xoNHWCGFbfXGF384Lr1AOomKLCWuMSTceXWh1fScLpg9STgfTiz6EEtdDw2SDMm2hsuy3rxUUNl/YARf3KzqMHCXFTDzP1xkoduPyosVNAUwFz6X3AcLEjmvOxW1qRoKNskt/5QEZqbjs=
